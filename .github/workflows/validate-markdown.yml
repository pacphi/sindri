---
# .github/workflows/validate-markdown.yml
# Markdown validation workflow
name: Validate Markdown

on:
  pull_request:
    paths:
      - "**.md"
      - ".github/workflows/validate-markdown.yml"
  push:
    branches: [main, feature/v3]
    paths:
      - "**.md"
      - ".github/workflows/validate-markdown.yml"
  workflow_dispatch:
  workflow_call:

jobs:
  markdownlint-v2:
    name: Markdownlint (v2)
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Set up Node.js
        uses: actions/setup-node@v6
        with:
          node-version: "24"

      - name: Install markdownlint-cli
        run: npm install -g markdownlint-cli

      - name: Lint v2 markdown files
        run: markdownlint 'v2/**/*.md' --ignore node_modules

  markdownlint-v3:
    name: Markdownlint (v3)
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Set up Node.js
        uses: actions/setup-node@v6
        with:
          node-version: "24"

      - name: Install markdownlint-cli
        run: npm install -g markdownlint-cli

      - name: Lint v3 markdown files
        run: |
          if [[ -d v3 ]]; then
            markdownlint 'v3/**/*.md' --ignore node_modules || echo "No v3 markdown issues or no files"
          else
            echo "No v3 directory found"
          fi

  markdownlint-root:
    name: Markdownlint (Root)
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Set up Node.js
        uses: actions/setup-node@v6
        with:
          node-version: "24"

      - name: Install markdownlint-cli
        run: npm install -g markdownlint-cli

      - name: Lint root markdown files
        run: |
          # Lint root-level markdown and .github markdown
          markdownlint '*.md' '.github/**/*.md' --ignore node_modules --ignore v2 --ignore v3
