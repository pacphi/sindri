---
# Sindri Configuration - Docker DevOps Example
# Local DevOps and infrastructure development with Docker-in-Docker support
#
# DinD Mode Options:
#   - sysbox: Secure DinD via Sysbox runtime (requires host setup)
#   - privileged: Legacy DinD with privileged mode (works everywhere)
#   - socket: Share host Docker daemon (simplest, least isolated)
#   - auto: Auto-detect best available mode (recommended)
#
# For Sysbox setup, run: ./scripts/setup-sysbox-host.sh

version: "1.0"
name: sindri-docker-devops

deployment:
  provider: docker-compose
  resources:
    memory: 8GB
    cpus: 4
  volumes:
    workspace:
      size: 50GB

extensions:
  profile: devops

# Cloud credentials for cloud-tools (included in devops profile)
secrets:
  - name: AWS_ACCESS_KEY_ID
    source: env
  - name: AWS_SECRET_ACCESS_KEY
    source: env
  - name: AZURE_CLIENT_ID
    source: env
  - name: AZURE_CLIENT_SECRET
    source: env
  - name: AZURE_TENANT_ID
    source: env

providers:
  docker:
    dind:
      enabled: true
      mode: auto # Uses sysbox if available, falls back to privileged
    ports:
      - "8080:8080" # Web UI
      - "9090:9090" # Prometheus
