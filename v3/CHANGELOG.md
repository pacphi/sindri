# Changelog - Sindri v3

All notable changes to Sindri v3 (Rust) will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

<!-- Entries below are auto-generated by release workflow -->

## [3.0.0-alpha.15] - 2026-02-04

### :bug: Bug Fixes

- fix(v3): replace netstat with ss in health check to fix fly.io deployments (7d7e6d6)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.15 for development (cb0a0ee)

### Installation

#### Docker Image
```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.15

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.15
```

#### CLI Binary
```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.15/sindri-v3.0.0-alpha.15-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.15-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.15/sindri-v3.0.0-alpha.15-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.15-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.14...v3.0.0-alpha.15



## [3.0.0-alpha.14] - 2026-02-04

### :bug: Bug Fixes

- fix(core): resolve clippy format-in-format-args warning (ca9349c)
- fix(v3): improve docker health check and standardize image defaults (4e5aaf5)

### :books: Documentation

- docs(providers): add multi-node cluster examples (505ca02)

### :wrench: Maintenance

- chore: upgrade ai-toolkit extension versions for grok and gemini clis (7180ddb)
- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.14 for development (e85fc72)

### Installation

#### Docker Image
```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.14

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.14
```

#### CLI Binary
```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.14/sindri-v3.0.0-alpha.14-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.14-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.14/sindri-v3.0.0-alpha.14-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.14-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.13...v3.0.0-alpha.14



## [3.0.0-alpha.13] - 2026-02-04

### :bug: Bug Fixes

- fix(extensions): disable Python compilation in mise for noexec /tmp (96211bb)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.13 for development (679e627)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.13

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.13
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.13/sindri-v3.0.0-alpha.13-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.13-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.13/sindri-v3.0.0-alpha.13-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.13-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.12...v3.0.0-alpha.13

## [3.0.0-alpha.12] - 2026-02-04

### :bug: Bug Fixes

- fix(extensions): download mise config files for downloaded mode (73a7972)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.12 for development (0839d21)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.12

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.12
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.12/sindri-v3.0.0-alpha.12-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.12-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.12/sindri-v3.0.0-alpha.12-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.12-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.11...v3.0.0-alpha.12

## [3.0.0-alpha.11] - 2026-02-03

### :bug: Bug Fixes

- fix(docker): add common.sh for downloaded mode extensions (ababb26)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.11 for development (c6fd44a)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.11

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.11
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.11/sindri-v3.0.0-alpha.11-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.11-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.11/sindri-v3.0.0-alpha.11-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.11-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.10...v3.0.0-alpha.11

## [3.0.0-alpha.10] - 2026-02-03

### :sparkles: Features

- feat(extensions): add Swift 6.2.3 language extension (9b5a052)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.10 for development (8b5eb7b)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.10

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.10
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.10/sindri-v3.0.0-alpha.10-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.10-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.10/sindri-v3.0.0-alpha.10-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.10-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.9...v3.0.0-alpha.10

## [3.0.0-alpha.9] - 2026-02-03

### :sparkles: Features

- feat(extensions): add Swift 6.2.3 language extension (347eeca)

### :bug: Bug Fixes

- fix(extensions): resolve doubled path in extension directory lookup (b6bfa24)

### :books: Documentation

- docs: clean up CHANGELOG duplicate entries from tag detection bug (6215d28)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.9 for development (b69e6d1)
- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.8 for development (9e23e73)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.9

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.9
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.9/sindri-v3.0.0-alpha.9-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.9-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.9/sindri-v3.0.0-alpha.9-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.9-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.7...v3.0.0-alpha.9

## [3.0.0-alpha.8] - 2026-02-03

### :bug: Bug Fixes

- fix(extensions): resolve doubled path in extension directory lookup (b6bfa24)

### :books: Documentation

- docs: clean up CHANGELOG duplicate entries from tag detection bug (6215d28)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and bump to v3.0.0-alpha.8 for development (9e23e73)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.8

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.8
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.8/sindri-v3.0.0-alpha.8-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.8-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.8/sindri-v3.0.0-alpha.8-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.8-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

**Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0-alpha.7...v3.0.0-alpha.8

## [3.0.0-alpha.7] - 2026-02-03

### :sparkles: Features

- feat(v3): migrate extension downloads to raw.githubusercontent.com (3295c2d)

### :bug: Bug Fixes

- fix(v3): resolve -c argument conflict in extension list command (4603305)

### :wrench: Maintenance

- chore(release): prepare v3.0.0-alpha.7 release (ae54829)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.7

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.7
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.7/sindri-v3.0.0-alpha.7-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.7-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.7/sindri-v3.0.0-alpha.7-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.7-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

## [3.0.0-alpha.6] - 2026-02-03

### :bug: Bug Fixes

- fix(v3): correct compatibility matrix URL and bundle in Docker image (a496d79)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and Cargo.toml for v3.0.0-alpha.6 (2be6e38)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.6

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.6
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.6/sindri-v3.0.0-alpha.6-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.6-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.6/sindri-v3.0.0-alpha.6-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.6-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

## [3.0.0-alpha.5] - 2026-02-03

### :sparkles: Features

- feat(v3): add unified extension source resolver and improve GHCR auth (3abcbe0)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and Cargo.toml for v3.0.0-alpha.5 (222e8f4)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.5

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.5
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.5/sindri-v3.0.0-alpha.5-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.5-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.5/sindri-v3.0.0-alpha.5-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.5-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

## [3.0.0-alpha.4] - 2026-02-03

### :bug: Bug Fixes

- fix(release): remove macOS x86_64 support from release pipeline (e27466c)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and Cargo.toml for v3.0.0-alpha.4 (6e57da4)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.4

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.4
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.4/sindri-v3.0.0-alpha.4-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.4-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.4/sindri-v3.0.0-alpha.4-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.4-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

## [3.0.0-alpha.3] - 2026-02-03

_Only release prep commit - no user-facing changes_

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and Cargo.toml for v3.0.0-alpha.3 (60ab8dd)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.3

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.3
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.3/sindri-v3.0.0-alpha.3-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.3-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.3/sindri-v3.0.0-alpha.3-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.3-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

## [3.0.0-alpha.2] - 2026-02-02

### :bug: Bug Fixes

- fix(release): resolve v3 build failures for ARM64 and Windows (fe25b4f)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and Cargo.toml for v3.0.0-alpha.2 (2e0f9b8)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.2

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.2
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.2/sindri-v3.0.0-alpha.2-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.2-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.2/sindri-v3.0.0-alpha.2-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.2-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

## [3.0.0-alpha.1] - 2026-02-02

### :sparkles: Features

- feat(v3): Implement Sindri v3 architecture with dual-version support (0abee17)
- feat(v3): production-ready v3 architecture with 90% faster builds (592686c)
- feat: v3 pre-release stabilization efforts (#50) (10b284d)
- feat: v3 stabilization efforts - part 2 (#51) (da3384d)
- feat: v3 vm command (#57) (cba8fe5)
- feat: v3 distribution preparation (#58) (6ba9a2b)

### :bug: Bug Fixes

- fix(security): resolve SSH private keys and GitHub CLI CVE vulnerabilities (439cfbc)

### :package: Dependencies

- deps(v3): upgrade which to 8.0 and dirs to 6.0 (573c35f)

### :wrench: Maintenance

- chore(release): update v3 CHANGELOG and Cargo.toml for v3.0.0-alpha.1 (0dbacf9)
- chore(deps): upgrade CLI dependencies and fix test flakiness (09e6192)
- chore(deps): upgrade Rust dependencies and GitHub Actions (43543fa)

### Installation

#### Docker Image

```bash
# Pull the Docker image
docker pull ghcr.io/pacphi/sindri:3.0.0-alpha.1

# Run a container
docker run -d --name sindri \
  -e SINDRI_PROFILE=minimal \
  -v sindri_home:/alt/home/developer \
  ghcr.io/pacphi/sindri:3.0.0-alpha.1
```

#### CLI Binary

```bash
# Download and install from release assets
# Linux (x86_64)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.1/sindri-v3.0.0-alpha.1-linux-x86_64.tar.gz
tar -xzf sindri-v3.0.0-alpha.1-linux-x86_64.tar.gz
sudo mv sindri /usr/local/bin/

# macOS (Apple Silicon)
wget https://github.com/pacphi/sindri/releases/download/v3.0.0-alpha.1/sindri-v3.0.0-alpha.1-macos-aarch64.tar.gz
tar -xzf sindri-v3.0.0-alpha.1-macos-aarch64.tar.gz
sudo mv sindri /usr/local/bin/
```

# Sindri V3 Changelog

All notable changes to Sindri V3 will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

---

## [Unreleased]

## [3.1.0] - 2026-01-28

### :boom: Breaking Changes

**Two-Dockerfile Architecture**

Sindri v3 now uses separate Dockerfiles for production and development modes:

- **Production** (`Dockerfile`): Pre-built binary, runtime extension installation, ~800MB
- **Development** (`Dockerfile.dev`): Source build, bundled extensions, ~1.2GB

**Environment Variable Changes**

Replaced dual environment variables with single unified variable:

- ❌ Removed: `SINDRI_BUILD_FROM_SOURCE` (boolean flag)
- ❌ Removed: `SINDRI_EXTENSIONS_SOURCE` (path string)
- ✅ Added: `SINDRI_EXT_HOME` (unified path variable)

**Path Resolution**

- Extension paths now use `${HOME}` variable expansion (not hardcoded `~` or `/home/developer`)
- Respects `ALT_HOME=/alt/home/developer` volume mount in containers
- Fallback resolution uses `dirs::home_dir()` and `$HOME` env var

### :sparkles: Features

- **Dockerfile Separation**: Production builds (2-5 min, ~800MB) vs Development builds (~8 min, ~1.2GB)
- **Simplified Configuration**: Single `SINDRI_EXT_HOME` variable replaces dual-variable system
- **Faster Production Builds**: Removed extension bundling reduces build time by 40-60%
- **Smaller Production Images**: Removed bundled extensions reduces image size by 33%
- **Volume Mount Support**: Proper `ALT_HOME` volume mount support via `${HOME}` expansion

### :bug: Bug Fixes

- **Path Resolution**: Fixed hardcoded paths that didn't respect `ALT_HOME` volume mount
- **Extension Loading**: Simplified extension loading priority eliminates confusion
- **Registry Loading**: Registry now correctly derives path from `SINDRI_EXT_HOME`

### :rocket: Improvements

- **Code Reduction**: 40-47% code reduction in extension loading logic across 5 Rust files
- **Build Performance**: Production builds 60% faster than previous unified Dockerfile
- **Image Size**: Production images 33% smaller (800MB vs 1.2GB)
- **Clarity**: Dockerfile choice (`Dockerfile` vs `Dockerfile.dev`) makes build mode immediately obvious

### :books: Documentation

- **New Guide**: [docs/DEPLOYMENT.md](docs/DEPLOYMENT.md) - Comprehensive Dockerfile selection guide
- **New ADR**: [ADR-040: Two-Dockerfile Architecture](docs/architecture/adr/040-two-dockerfile-architecture.md)
- **Updated**: [README.md](README.md#building-docker-images) - Build instructions for both Dockerfiles
- **Updated**: [docs/EXTENSIONS.md](docs/EXTENSIONS.md#extension-loading-mechanisms) - New extension loading priority

### :wrench: Migration Guide

#### For Default Users (No Action Required)

If using default `sindri.yaml` without custom build scripts, migration is automatic.

#### For Users with Custom Build Scripts

**Update Docker Build Commands**:

```bash
# Before (v3.0.x)
docker build -f v3/Dockerfile --build-arg BUILD_FROM_SOURCE=true -t sindri:dev .

# After (v3.1.0)
docker build -f v3/Dockerfile.dev -t sindri:dev .  # Development mode
docker build -f v3/Dockerfile -t sindri:prod .     # Production mode
```

**Update Environment Variable References**:

```bash
# Before (v3.0.x)
if [ "$SINDRI_BUILD_FROM_SOURCE" = "true" ]; then
    EXT_PATH=$SINDRI_EXTENSIONS_SOURCE
else
    EXT_PATH=~/.sindri/extensions
fi

# After (v3.1.0)
EXT_PATH=${SINDRI_EXT_HOME:-${HOME}/.sindri/extensions}
```

**Update Path References**:

```bash
# Before (v3.0.x) - Hardcoded paths
EXTENSIONS_DIR=~/.sindri/extensions
EXTENSIONS_DIR=/home/developer/.sindri/extensions

# After (v3.1.0) - Use ${HOME} variable
EXTENSIONS_DIR=${HOME}/.sindri/extensions
EXTENSIONS_DIR=${SINDRI_EXT_HOME}
```

#### For CI/CD Pipelines

**GitHub Actions**:

```yaml
# No changes needed if using v3/Dockerfile
# CI automatically uses production Dockerfile with pre-built binary

# Before (v3.0.x)
build-args: |
  BUILD_FROM_SOURCE=false

# After (v3.1.0) - Remove build arg
build-args: |
  SINDRI_VERSION=${{ env.VERSION }}
```

**Makefile**:

```makefile
# Before (v3.0.x)
docker build --build-arg BUILD_FROM_SOURCE=true -f v3/Dockerfile .

# After (v3.1.0)
docker build -f v3/Dockerfile.dev .  # Development
# OR
docker build -f v3/Dockerfile .       # Production
```

### :construction: Affected Files

**Core Changes** (7 files):

- `v3/Dockerfile` - Rewritten for production (pre-built binary, no bundled extensions)
- `v3/Dockerfile.dev` - New development Dockerfile (source build, bundled extensions)
- `v3/crates/sindri-extensions/src/profile.rs` - Simplified extension loading (43 → 25 lines)
- `v3/crates/sindri-extensions/src/registry.rs` - Unified registry loading
- `v3/crates/sindri/src/commands/extension.rs` - Simplified get_extensions_dir() (17 → 9 lines)
- `v3/crates/sindri/src/commands/profile.rs` - Unified path resolution
- `v3/crates/sindri-providers/src/templates/context.rs` - SINDRI_EXT_HOME configuration

**Provider Integration** (4 files):

- `v3/crates/sindri-providers/src/docker.rs` - Dockerfile selection logic
- `v3/crates/sindri-providers/src/fly.rs` - Dockerfile path selection
- `v3/crates/sindri-providers/src/devpod.rs` - Build mode handling
- `v3/crates/sindri-providers/src/e2b.rs` - Template generation

**Build System** (2 files):

- `Makefile` - Updated Docker build targets
- `.github/workflows/ci-v3.yml` - Removed BUILD_FROM_SOURCE arg

**Documentation** (5 files):

- `v3/README.md` - Build instructions
- `v3/docs/EXTENSIONS.md` - Extension loading mechanisms
- `v3/docs/DEPLOYMENT.md` - Dockerfile selection guide
- `v3/docs/architecture/adr/040-two-dockerfile-architecture.md` - ADR document
- `v3/CHANGELOG.md` - This file

### Installation

**Using Sindri CLI** (Recommended):

```bash
# Deploy with production image (default)
sindri deploy

# Deploy with development image (build from source)
sindri config init --profile fullstack
# Edit sindri.yaml:
#   deployment:
#     buildFromSource:
#       enabled: true
sindri deploy
```

**Manual Docker Build**:

```bash
# Production image (pre-built binary, no extensions)
docker build -f v3/Dockerfile -t sindri:3.1.0 .

# Development image (source build, bundled extensions)
docker build -f v3/Dockerfile.dev -t sindri:3.1.0-dev .
```

**Using Makefile**:

```bash
# Production
make v3-docker-build-from-binary

# Development
make v3-docker-build-from-source
```

### :link: References

- **Full Changelog**: https://github.com/pacphi/sindri/compare/v3.0.0...v3.1.0
- **ADR-040**: [Two-Dockerfile Architecture](docs/architecture/adr/040-two-dockerfile-architecture.md)
- **Migration Guide**: [V2 to V3 Migration Guide](../docs/v2-v3-migration-guide.md)

---

## [3.0.0] - 2026-01-XX

### :sparkles: Initial Release

Complete rewrite of Sindri in Rust with improved performance, enhanced security, and native container image management.

**Key Features**:

- Multi-provider support (Docker, Fly.io, DevPod, Kubernetes, E2B)
- 40+ modular extensions
- Multi-backend secrets management
- Full workspace backup with encryption
- Project scaffolding templates
- Image security with signature verification
- Local Kubernetes cluster management
- Automatic CLI updates
- Schema validation
- System diagnostics with auto-fix

See [v3/README.md](README.md) for complete feature list and getting started guide.

---

[Unreleased]: https://github.com/pacphi/sindri/compare/v3.1.0...HEAD
[3.1.0]: https://github.com/pacphi/sindri/compare/v3.0.0...v3.1.0
[3.0.0]: https://github.com/pacphi/sindri/releases/tag/v3.0.0
