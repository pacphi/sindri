# =============================================================================
# Sindri Configuration
# =============================================================================
# Documentation: https://sindri.dev/docs
# Schema: https://sindri.dev/schemas/sindri.schema.json
#
# Quick commands:
#   sindri config validate  - Validate this configuration
#   sindri deploy           - Deploy environment
#   sindri connect          - Connect to running environment
#   sindri status           - Show deployment status
# =============================================================================

version: "3.0"
name: {{ name }}

# =============================================================================
# DEPLOYMENT
# =============================================================================
deployment:
  provider: {{ provider }}

  # ═══════════════════════════════════════════════════════════════════════════
  # IMAGE DEPLOYMENT OPTIONS
  # ═══════════════════════════════════════════════════════════════════════════
  #
  # Choose ONE of the following image configuration methods:
  #
  # ───────────────────────────────────────────────────────────────────────────
  # Option 1: Pre-built image (legacy - simple)
  # ───────────────────────────────────────────────────────────────────────────
  # image: ghcr.io/myorg/app:v1.0.0
  #
  # ───────────────────────────────────────────────────────────────────────────
  # Option 2: Semantic versioning with verification (recommended)
  # ───────────────────────────────────────────────────────────────────────────
  # image_config:
  #   registry: ghcr.io/myorg/app
  #   version: "^1.0.0"           # Resolves to latest 1.x.x
  #   verify_signature: true      # Verify with cosign
  #   verify_provenance: true     # Verify SLSA provenance
  #   pull_policy: IfNotPresent   # Always | IfNotPresent | Never
  #
  # ───────────────────────────────────────────────────────────────────────────
  # Option 3: Explicit tag override
  # ───────────────────────────────────────────────────────────────────────────
  # image_config:
  #   registry: ghcr.io/myorg/app
  #   tag_override: v1.0.0-beta.1
  #
  # ───────────────────────────────────────────────────────────────────────────
  # Option 4: Immutable digest (production)
  # ───────────────────────────────────────────────────────────────────────────
  # image_config:
  #   registry: ghcr.io/myorg/app
  #   digest: sha256:abc123...
  #
  # ───────────────────────────────────────────────────────────────────────────
  # Option 5: Build from local Dockerfile
  # ───────────────────────────────────────────────────────────────────────────
  # (Leave image/image_config commented out)
  # Sindri will build from ./Dockerfile if no image specified
  # Supported providers: docker, fly, devpod, e2b
  #
  # ═══════════════════════════════════════════════════════════════════════════
  # IMAGE RESOLUTION PRIORITY ORDER
  # ═══════════════════════════════════════════════════════════════════════════
  # 1. image_config.digest      (immutable - highest priority)
  # 2. image_config.tag_override (explicit tag)
  # 3. image_config.version     (semver constraint resolution)
  # 4. image                    (legacy full reference)
  # 5. Local Dockerfile         (provider-dependent build)
  # 6. Default: ghcr.io/pacphi/sindri:v3-latest
  # ═══════════════════════════════════════════════════════════════════════════
{% if provider == "kubernetes" %}
  # Kubernetes does NOT support building from Dockerfile.
  # You MUST specify a pre-built image for this provider.
  image: ghcr.io/pacphi/sindri:v3-latest
{% elif provider == "fly" %}
  # Fly.io: Pre-built image (~30s deploy) or Dockerfile build (2-5 min)
  image: ghcr.io/pacphi/sindri:v3-latest
{% elif provider == "e2b" %}
  # E2B requires Dockerfile build (pre-built images not supported)
  # Leave image commented out - E2B builds template from Dockerfile
{% else %}
  image: ghcr.io/pacphi/sindri:v3-latest
{% endif %}

  resources:
    memory: 4GB     # 1GB, 2GB, 4GB, 8GB, 16GB
    cpus: 2         # 1-8
{% if provider_supports_gpu %}

    # GPU support (optional - uncomment to enable)
    # gpu:
    #   enabled: true
    #   type: nvidia          # nvidia | amd
    #   count: 1              # Number of GPUs (1-8)
    #   tier: gpu-medium      # gpu-small, gpu-medium, gpu-large, gpu-xlarge
    #   memory: 16GB          # Minimum GPU memory required
{% if provider == "fly" %}
    #
    # GPU machines available in limited regions:
    #   - ord (Chicago, US Central)
    #   - sjc (San Jose, US West)
    # Other regions may not have GPU capacity.
{% elif provider == "devpod" %}
    #
    # GPU tier to cloud instance mappings:
    #   AWS:
    #     gpu-small:  g4dn.xlarge (T4, 16GB)
    #     gpu-medium: g5.2xlarge (A10G, 24GB)
    #     gpu-large:  g5.4xlarge (A10G, 24GB)
    #     gpu-xlarge: p4d.24xlarge (A100 x8, 640GB)
    #   GCP:
    #     gpu-small:  n1-standard-4 + nvidia-tesla-t4
    #     gpu-medium: n1-standard-8 + nvidia-tesla-a10g
    #     gpu-large:  g2-standard-16 + nvidia-l4
    #     gpu-xlarge: a2-megagpu-16g + nvidia-a100-80gb x8
    #   Azure:
    #     gpu-small:  Standard_NC4as_T4_v3
    #     gpu-medium: Standard_NC8as_T4_v3
    #     gpu-large:  Standard_NC24ads_A100_v4
    #     gpu-xlarge: Standard_ND96amsr_A100_v4
{% endif %}
{% endif %}

  volumes:
    workspace:
      path: /alt/home/developer/workspace
      size: 10GB

# =============================================================================
# EXTENSIONS
# =============================================================================
extensions:
  profile: {{ profile }}

  # Available profiles:
{% for p in profiles %}
  #   {{ p.name }} - {{ p.description }}
{% endfor %}

  # Or use explicit extension list (mutually exclusive with profile):
  # active:
  #   - nodejs
  #   - python
  #   - docker

  # Add extensions on top of a profile:
  # additional:
  #   - ollama
  #   - monitoring

  auto_install: true   # Auto-install on startup (set false for CI/testing)

# =============================================================================
# SECRETS
# =============================================================================
# Secrets are injected as environment variables into the container.
# Source types: env (from host), file (mount as file), vault (HashiCorp Vault)
secrets:
  # ---------------------------------------------------------------------------
  # Core Authentication
  # ---------------------------------------------------------------------------
  # SSH public key for VS Code Remote/SSH access
  - name: AUTHORIZED_KEYS
    source: env
    fromFile: ~/.ssh/id_ed25519.pub

  # ---------------------------------------------------------------------------
  # Git & Source Control
  # ---------------------------------------------------------------------------
  - name: GITHUB_TOKEN
    source: env
  - name: GIT_USER_NAME
    source: env
  - name: GIT_USER_EMAIL
    source: env
  # - name: GITHUB_USER              # GitHub username for gh CLI
  #   source: env
  # - name: GITLAB_TOKEN             # GitLab personal access token
  #   source: env
  # - name: BITBUCKET_TOKEN          # Bitbucket app password
  #   source: env

  # ---------------------------------------------------------------------------
  # AI Services - Primary
  # ---------------------------------------------------------------------------
  - name: ANTHROPIC_API_KEY
    source: env
  # - name: OPENAI_API_KEY           # OpenAI API (GPT, Codex, DALL-E)
  #   source: env
  # - name: OPENROUTER_API_KEY       # OpenRouter multi-provider gateway (claudish)
  #   source: env

  # ---------------------------------------------------------------------------
  # AI Services - Additional Providers
  # ---------------------------------------------------------------------------
  # - name: GOOGLE_GEMINI_API_KEY    # Google Gemini API (ai-toolkit)
  #   source: env
  # - name: XAI_API_KEY              # xAI Grok SDK (ai-toolkit)
  #   source: env
  # - name: PERPLEXITY_API_KEY       # Perplexity AI research (ruvnet-research)
  #   source: env
  # - name: DEEPSEEK_API_KEY         # DeepSeek AI reasoning
  #   source: env
  # - name: COHERE_API_KEY           # Cohere NLP
  #   source: env
  # - name: MISTRAL_API_KEY          # Mistral AI
  #   source: env
  # - name: GROQ_API_KEY             # Groq inference
  #   source: env
  # - name: TOGETHER_API_KEY         # Together AI
  #   source: env
  # - name: FIREWORKS_API_KEY        # Fireworks AI
  #   source: env
  # - name: REPLICATE_API_TOKEN      # Replicate
  #   source: env
  # - name: HUGGINGFACE_TOKEN        # HuggingFace Hub
  #   source: env

  # ---------------------------------------------------------------------------
  # Cloud Providers - AWS
  # ---------------------------------------------------------------------------
  # - name: AWS_ACCESS_KEY_ID        # AWS access key
  #   source: env
  # - name: AWS_SECRET_ACCESS_KEY    # AWS secret key
  #   source: env
  # - name: AWS_SESSION_TOKEN        # AWS temporary session token (STS)
  #   source: env
  # - name: AWS_DEFAULT_REGION       # AWS default region
  #   source: env

  # ---------------------------------------------------------------------------
  # Cloud Providers - Azure
  # ---------------------------------------------------------------------------
  # - name: AZURE_CLIENT_ID          # Azure service principal app ID
  #   source: env
  # - name: AZURE_CLIENT_SECRET      # Azure service principal secret
  #   source: env
  # - name: AZURE_TENANT_ID          # Azure AD tenant ID
  #   source: env
  # - name: AZURE_SUBSCRIPTION_ID    # Azure subscription ID
  #   source: env

  # ---------------------------------------------------------------------------
  # Cloud Providers - Google Cloud
  # ---------------------------------------------------------------------------
  # - name: GOOGLE_APPLICATION_CREDENTIALS  # Path to GCP service account JSON
  #   source: env
  # - name: GOOGLE_CLOUD_PROJECT     # GCP project ID
  #   source: env
  # - name: CLOUDSDK_CORE_PROJECT    # Alternative GCP project setting
  #   source: env

  # ---------------------------------------------------------------------------
  # Cloud Providers - Other Clouds
  # ---------------------------------------------------------------------------
  # - name: FLY_API_TOKEN            # Fly.io API token
  #   source: env

  # DigitalOcean
  # - name: DIGITALOCEAN_ACCESS_TOKEN  # DigitalOcean API token
  #   source: env

  # Oracle Cloud Infrastructure (OCI)
  # - name: OCI_CLI_USER             # OCI user OCID
  #   source: env
  # - name: OCI_CLI_FINGERPRINT      # OCI API key fingerprint
  #   source: env
  # - name: OCI_CLI_TENANCY          # OCI tenancy OCID
  #   source: env
  # - name: OCI_CLI_REGION           # OCI region
  #   source: env
  # - name: OCI_CLI_KEY_FILE         # Path to OCI private key
  #   source: env

  # Alibaba Cloud
  # - name: ALIBABA_CLOUD_ACCESS_KEY_ID      # Alibaba Cloud access key
  #   source: env
  # - name: ALIBABA_CLOUD_ACCESS_KEY_SECRET  # Alibaba Cloud secret key
  #   source: env
  # - name: ALIBABA_CLOUD_SECURITY_TOKEN     # Alibaba Cloud STS token
  #   source: env

  # IBM Cloud
  # - name: IBMCLOUD_API_KEY         # IBM Cloud API key
  #   source: env
  # - name: IC_REGION                # IBM Cloud region
  #   source: env

  # ---------------------------------------------------------------------------
  # Infrastructure as Code
  # ---------------------------------------------------------------------------
  # - name: PULUMI_ACCESS_TOKEN      # Pulumi Cloud authentication
  #   source: env
  # - name: PULUMI_CONFIG_PASSPHRASE # Pulumi secrets encryption passphrase
  #   source: env
  # - name: TERRAFORM_TOKEN          # HCP Terraform/Terraform Cloud token
  #   source: env
  # - name: TF_TOKEN_app_terraform_io  # HCP Terraform token (alternative)
  #   source: env

  # ---------------------------------------------------------------------------
  # Package Registries
  # ---------------------------------------------------------------------------
  # - name: NPM_TOKEN                # npm registry auth (bypasses rate limits)
  #   source: env
  # - name: PYPI_TOKEN               # PyPI package publishing
  #   source: env
  # - name: NUGET_API_KEY            # NuGet package publishing
  #   source: env
  # - name: CARGO_REGISTRY_TOKEN    # crates.io publishing
  #   source: env
  # - name: MAVEN_USERNAME           # Maven Central username
  #   source: env
  # - name: MAVEN_PASSWORD           # Maven Central password/token
  #   source: env

  # ---------------------------------------------------------------------------
  # Container Registries
  # ---------------------------------------------------------------------------
  # - name: DOCKER_USERNAME          # Docker Hub username
  #   source: env
  # - name: DOCKER_PASSWORD          # Docker Hub password/token
  #   source: env
  # - name: GHCR_TOKEN               # GitHub Container Registry (use GITHUB_TOKEN)
  #   source: env

  # ---------------------------------------------------------------------------
  # Project Management & Collaboration
  # ---------------------------------------------------------------------------
  # - name: LINEAR_API_KEY           # Linear.app issue tracking
  #   source: env
  # - name: JIRA_URL                 # Atlassian Jira base URL
  #   source: env                    # Example: https://mycompany.atlassian.net
  # - name: JIRA_USERNAME            # Atlassian account email
  #   source: env
  # - name: JIRA_API_TOKEN           # Atlassian API token
  #   source: env
  # - name: SLACK_TOKEN              # Slack bot/user token
  #   source: env
  # - name: DISCORD_TOKEN            # Discord bot token
  #   source: env
  # - name: NOTION_API_KEY           # Notion integration token
  #   source: env

  # ---------------------------------------------------------------------------
  # Backend Services & Databases
  # ---------------------------------------------------------------------------
  # - name: SUPABASE_ACCESS_TOKEN    # Supabase CLI authentication
  #   source: env
  # - name: SUPABASE_URL             # Supabase project URL
  #   source: env
  # - name: SUPABASE_ANON_KEY        # Supabase anonymous key
  #   source: env
  # - name: SUPABASE_SERVICE_ROLE_KEY  # Supabase service role key
  #   source: env
  # - name: DATABASE_URL             # Generic database connection string
  #   source: env
  # - name: REDIS_URL                # Redis connection URL
  #   source: env
  # - name: MONGODB_URI              # MongoDB connection string
  #   source: env

  # ---------------------------------------------------------------------------
  # Monitoring & Observability
  # ---------------------------------------------------------------------------
  # - name: DATADOG_API_KEY          # Datadog API key
  #   source: env
  # - name: SENTRY_DSN               # Sentry error tracking DSN
  #   source: env
  # - name: GRAFANA_API_KEY          # Grafana Cloud API key
  #   source: env
  # - name: NEW_RELIC_LICENSE_KEY    # New Relic license key
  #   source: env

  # ---------------------------------------------------------------------------
  # MCP Servers & Tools
  # ---------------------------------------------------------------------------
  # - name: CONTEXT7_API_KEY         # Context7 MCP (optional, higher rate limits)
  #   source: env

  # ---------------------------------------------------------------------------
  # File Mount Examples
  # ---------------------------------------------------------------------------
  # Mount a file into the container:
  # - name: SSL_CERT
  #   source: file
  #   path: ./certs/server.crt
  #   mountPath: /etc/ssl/certs/server.crt
  #   permissions: "0644"

  # Mount GCP service account JSON:
  # - name: GCP_SERVICE_ACCOUNT
  #   source: file
  #   path: ~/.config/gcloud/service-account.json
  #   mountPath: /home/developer/.config/gcloud/service-account.json
  #   permissions: "0600"

  # ---------------------------------------------------------------------------
  # HashiCorp Vault Integration
  # ---------------------------------------------------------------------------
  # - name: DB_PASSWORD
  #   source: vault
  #   vaultPath: secret/data/myapp/database
  #   vaultKey: password
  #   vaultMount: secret
{% if provider == "fly" %}

# ---------------------------------------------------------------------------
# Fly.io Secrets Deployment
# ---------------------------------------------------------------------------
# After deploying, set secrets via Fly.io CLI:
#
#   flyctl secrets set KEY=value -a {{ name }}
#
# Examples:
#   flyctl secrets set "AUTHORIZED_KEYS=$(cat ~/.ssh/id_ed25519.pub)" -a {{ name }}
#   flyctl secrets set ANTHROPIC_API_KEY=sk-ant-... -a {{ name }}
#   flyctl secrets set GITHUB_TOKEN=ghp_... -a {{ name }}
#
# List all secrets:     flyctl secrets list -a {{ name }}
# Remove a secret:      flyctl secrets unset KEY -a {{ name }}
#
# See the SECRETS section above for the full list of supported environment variables.
{% endif %}

# =============================================================================
# PROVIDER CONFIGURATION
# =============================================================================
providers:
{% if provider == "fly" %}
  # ---------------------------------------------------------------------------
  # Fly.io Configuration
  # ---------------------------------------------------------------------------
  fly:
    region: {{ default_region }}              # sjc, ord, iad, ams, nrt, fra, syd
    autoStopMachines: true     # Suspend when idle (cost savings)
    autoStartMachines: true    # Resume on connection
    cpuKind: shared            # shared | performance (dedicated)
    sshPort: 10022             # External SSH port

    # organization: my-org     # Fly.io organization (optional)
    # highAvailability: false  # Enable multiple machines

  # ---------------------------------------------------------------------------
  # VS Code Remote SSH Setup
  # ---------------------------------------------------------------------------
  # 1. Ensure AUTHORIZED_KEYS secret is set above
  # 2. Deploy: sindri deploy
  # 3. Add to ~/.ssh/config:
  #
  #    Host sindri-{{ name }}
  #        HostName {{ name }}.fly.dev
  #        Port 10022
  #        User developer
  #        StrictHostKeyChecking no
  #
  # 4. Connect in VS Code: Cmd+Shift+P -> "Remote-SSH: Connect to Host"
  # 5. Or via terminal: ssh sindri-{{ name }}

  # ---------------------------------------------------------------------------
  # Fly.io Development Workflow
  # ---------------------------------------------------------------------------
  # 1. Deploy: sindri deploy
  # 2. Set secrets (see "Fly.io Secrets Deployment" section above)
  # 3. Connect: ssh developer@{{ name }}.fly.dev -p 10022
  #    Alternative: flyctl ssh console -a {{ name }}
  # 4. Work: All files in $HOME (/alt/home/developer) are persistent
  #    Projects go in $WORKSPACE (/alt/home/developer/workspace)
  # 5. Idle: VM automatically suspends after inactivity
  # 6. Resume: VM starts automatically on next connection
{% elif provider == "docker" %}
  # ---------------------------------------------------------------------------
  # Docker Compose Configuration
  # ---------------------------------------------------------------------------
  docker:
    network: bridge            # bridge | host | none
    restart: unless-stopped    # no | always | on-failure | unless-stopped
    # runtime: auto            # auto | runc | sysbox-runc
    # privileged: false        # Only for legacy DinD (security risk)

    # Additional port mappings
    # ports:
    #   - "3000:3000"          # Web app
    #   - "5432:5432"          # PostgreSQL

    # Extra hosts (useful for local development)
    # extraHosts:
    #   - "host.docker.internal:host-gateway"
{% if provider_supports_dind %}

    # ---------------------------------------------------------------------------
    # Docker-in-Docker (DinD) Configuration
    # ---------------------------------------------------------------------------
    # Enable running Docker commands inside Sindri containers.
    # Required for running containers, building images, or docker-compose inside Sindri.
    #
    # dind:
    #   enabled: true
    #   mode: auto             # Detection order: sysbox > privileged > socket
    #   storageDriver: auto    # auto | overlay2 | fuse-overlayfs | vfs
    #   storageSize: 20GB      # Size limit for Docker storage (vfs mode)
    #
    # DinD Mode Details:
    #
    #   sysbox (Recommended)
    #     - Secure isolation using Sysbox runtime
    #     - Requires host setup: ./scripts/setup-sysbox-host.sh
    #     - Best security, uses overlay2 storage driver
    #     - Full Docker functionality without security compromise
    #
    #   privileged (Legacy)
    #     - Works everywhere but less secure
    #     - Uses vfs storage driver (slower, more disk space)
    #     - Container has elevated privileges on host
    #     - Only use when sysbox is unavailable
    #
    #   socket (Simple)
    #     - Shares host Docker daemon via socket mount
    #     - Simple setup, no additional privileges
    #     - Inner containers run on host Docker (not isolated)
    #     - Good for CI/CD pipelines that just need docker commands
    #
    #   auto (Default)
    #     - Auto-detect: sysbox if available, else check privileged flag
    #     - Falls back to socket if neither available
{% endif %}
{% elif provider == "kubernetes" %}
  # ---------------------------------------------------------------------------
  # Kubernetes Configuration
  # ---------------------------------------------------------------------------
  kubernetes:
    namespace: {{ default_region }}
    # storageClass: standard   # Storage class for PVCs

    # Ingress configuration (optional)
    # ingress:
    #   enabled: true
    #   hostname: sindri.example.com

  # ---------------------------------------------------------------------------
  # Local Kubernetes Clusters (kind/k3d)
  # ---------------------------------------------------------------------------
  # For local development, use kind or k3d to create a K8s cluster:
  #
  # kind (Kubernetes IN Docker) - Full K8s
  #   Context: kind-<cluster-name>
  #   Install: brew install kind (macOS) or direct download
  #   Create: sindri k8s create --provider kind --name my-cluster
  #   Image loading: kind load docker-image <image> --name <cluster>
  #
  # k3d (K3s in Docker) - Lightweight K8s
  #   Context: k3d-<cluster-name>
  #   Install: brew install k3d (macOS) or curl install script
  #   Create: sindri k8s create --provider k3d --name my-cluster
  #   Image loading: k3d image import <image> --cluster <cluster>
  #   Built-in registry: k3d cluster create --registry-create
  #
  # Commands:
  #   sindri k8s create --provider kind --name my-cluster
  #   sindri k8s create --provider k3d --name my-cluster
  #   sindri k8s list    # Show all kind and k3d clusters
  #   sindri k8s destroy --name my-cluster
  #
  # k8s:
  #   provider: kind              # kind | k3d
  #   clusterName: {{ name }}
  #   version: v1.31.0           # Kubernetes version
  #   nodes: 1                   # 1 = single node, >1 = multi-node
  #
  #   # k3d-specific: local registry
  #   # k3d:
  #   #   registry:
  #   #     enabled: true
  #   #     name: k3d-registry
  #   #     port: 5000
  #   #
  #   # Usage:
  #   #   docker tag myimage localhost:5000/myimage
  #   #   docker push localhost:5000/myimage
  #   #   # Images available in cluster at k3d-registry:5000/myimage
{% elif provider == "devpod" %}
  # ---------------------------------------------------------------------------
  # DevPod Configuration
  # ---------------------------------------------------------------------------
  # DevPod supports multiple backend providers. Specify your target.
  devpod:
    type: docker               # aws | gcp | azure | digitalocean | kubernetes | ssh | docker

    # For cloud providers, specify a build repository for image push:
    # buildRepository: ghcr.io/myorg/sindri

    # AWS EC2 options (when type: aws)
    # aws:
    #   region: {{ default_region }}
    #   instanceType: c5.xlarge
    #   diskSize: 40            # GB
    #   useSpot: false          # Use spot instances for cost savings
    #   # subnetId: subnet-xxx
    #   # securityGroupId: sg-xxx

    # GCP Compute Engine options (when type: gcp)
    # gcp:
    #   project: my-gcp-project
    #   zone: us-central1-a
    #   machineType: e2-standard-4
    #   diskSize: 40
    #   diskType: pd-balanced   # pd-standard | pd-balanced | pd-ssd

    # Azure VM options (when type: azure)
    # azure:
    #   subscription: xxx-xxx-xxx
    #   resourceGroup: devpod-resources
    #   location: eastus
    #   vmSize: Standard_D4s_v3
    #   diskSize: 40

    # DigitalOcean Droplet options (when type: digitalocean)
    # digitalocean:
    #   region: nyc3
    #   size: s-4vcpu-8gb

    # Kubernetes pod options (when type: kubernetes)
    # kubernetes:
    #   namespace: devpod
    #   # storageClass: standard
    #   # context: my-cluster
    #   #
    #   # Local K8s cluster detection:
    #   #   - kind: context pattern "kind-<cluster-name>"
    #   #   - k3d: context pattern "k3d-<cluster-name>"
    #   #
    #   # Benefits of local cluster:
    #   #   - No registry push needed (image loaded directly)
    #   #   - Faster iteration cycle
    #   #   - No registry auth required

    # SSH to existing machine (when type: ssh)
    # ssh:
    #   host: 192.168.1.100
    #   user: developer
    #   port: 22
    #   keyPath: ~/.ssh/id_rsa

  # ---------------------------------------------------------------------------
  # Docker Registry Authentication
  # ---------------------------------------------------------------------------
  # For cloud deployments (AWS, GCP, Azure), you need registry auth:
  #
  # ghcr.io (GitHub):
  #   Set GITHUB_TOKEN environment variable
  #   Or: echo $GITHUB_TOKEN | docker login ghcr.io -u <username> --password-stdin
  #
  # AWS ECR:
  #   aws ecr get-login-password --region <region> | docker login ...
  #
  # GCP GCR/Artifact Registry:
  #   Set GOOGLE_APPLICATION_CREDENTIALS
  #   Or: gcloud auth configure-docker
  #
  # Generic:
  #   Set DOCKER_USERNAME and DOCKER_PASSWORD
  #   Or add to .env/.env.local
{% elif provider == "e2b" %}
  # ---------------------------------------------------------------------------
  # E2B Cloud Sandbox Configuration
  # ---------------------------------------------------------------------------
  # E2B provides instant cloud sandboxes optimized for AI agents.
  # Required: E2B_API_KEY from https://e2b.dev/dashboard
  e2b:
    timeout: 300               # Sandbox timeout in seconds (default: 5 min)
    autoPause: true            # Pause instead of kill on timeout
    autoResume: true           # Auto-resume paused sandbox on connect
    internetAccess: true       # Enable outbound internet

    # Template configuration
    # templateAlias: my-template
    # reuseTemplate: true
    # buildOnDeploy: false     # Force rebuild on every deploy

    # Network restrictions
    # allowedDomains: []       # Whitelist (empty = all allowed)
    # blockedDomains: []       # Blacklist

    # publicAccess: false      # Allow public URL access to services
    # team: my-team            # E2B team for billing

    # Custom metadata
    # metadata:
    #   project: my-project
    #   environment: development

  # ---------------------------------------------------------------------------
  # E2B Limitations
  # ---------------------------------------------------------------------------
  # - No GPU support (use fly/devpod/docker for GPU workloads)
  # - No SSH access (uses WebSocket PTY terminal instead)
  # - Max 24hr active session, 30-day pause retention
  # - ~150ms startup time (after template is built)
  #
  # Pause/Resume workflow:
  #   sindri pause    - Preserves memory + filesystem state
  #   sindri connect  - Auto-resumes if autoResume: true

  # ---------------------------------------------------------------------------
  # E2B Cost Optimization Tips
  # ---------------------------------------------------------------------------
  # - Use short timeouts (300s) for interactive development
  # - Enable autoPause to avoid paying for idle time
  # - Consider timeout: 60 for automated testing
  # - Set buildOnDeploy: false to reuse templates (faster startup)
  # - Paused sandboxes: no compute cost (only snapshot storage)
  # - Data expires 30 days from initial sandbox creation
{% endif %}
