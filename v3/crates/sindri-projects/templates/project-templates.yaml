---
version: "2.0"

templates:
  # Language-based templates
  node:
    description: "Node.js application"
    aliases: ["nodejs", "javascript"]
    extensions:
      - nodejs
    detection_patterns: ["node", "npm", "express", "js", "typescript", "ts"]
    setup_commands:
      - "npm init -y"
    dependencies:
      detect: "package.json"
      command: "npm install"
      requires: "npm"
      description: "Node.js dependencies"
    files:
      "package.json": |
        {
          "name": "{project_name}",
          "version": "1.0.0",
          "main": "index.js",
          "scripts": {
            "start": "node index.js",
            "dev": "nodemon index.js",
            "test": "jest"
          }
        }
      ".gitignore": |
        # Dependencies
        node_modules/
        jspm_packages/

        # Build outputs
        dist/
        build/
        *.min.js
        *.min.css

        # Logs
        logs/
        *.log
        npm-debug.log*
        yarn-debug.log*
        yarn-error.log*

        # Environment
        .env
        .env.local
        .env.*.local

        # IDE
        .vscode/
        .idea/
        *.swp
        *.swo
        *~

        # OS
        .DS_Store
        Thumbs.db

        # Testing
        coverage/
        .nyc_output/

        # Temporary
        tmp/
        temp/
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Node.js application for [brief description].

      ## Setup Instructions
      ```bash
      npm install
      npm run dev
      ```

      ## Development Commands
      - `npm start` - Start the application
      - `npm run dev` - Start with auto-reload
      - `npm test` - Run tests

      ## Architecture Notes
      [Add architectural decisions and patterns]

  python:
    description: "Python application"
    aliases: ["py", "python3"]
    extensions:
      - python
    detection_patterns:
      - "python"
      - "py"
      - "django"
      - "flask"
      - "fastapi"
      - "ml"
      - "data"
    setup_commands:
      - "python3 -m venv venv"
      - "source venv/bin/activate || . venv/bin/activate"
      - "touch requirements.txt"
    dependencies:
      detect: "requirements.txt"
      command: "pip3 install -r requirements.txt"
      requires: "pip3"
      description: "Python dependencies"
    files:
      "requirements.txt": ""
      "main.py": |
        #!/usr/bin/env python3
        """
        {project_name} - Python application
        """

        def main():
            print("Hello from {project_name}!")

        if __name__ == "__main__":
            main()
      ".gitignore": |
        # Byte-compiled / optimized
        __pycache__/
        *.py[cod]
        *$py.class
        *.so

        # Virtual Environment
        venv/
        env/
        ENV/
        .venv

        # Distribution / packaging
        .Python
        build/
        develop-eggs/
        dist/
        downloads/
        eggs/
        .eggs/
        lib/
        lib64/
        parts/
        sdist/
        var/
        wheels/
        *.egg-info/
        .installed.cfg
        *.egg

        # Testing
        .tox/
        .coverage
        .coverage.*
        .cache
        .pytest_cache/
        htmlcov/

        # Environment
        .env
        *.env

        # IDE
        .vscode/
        .idea/
        *.swp
        *.swo

        # Jupyter
        .ipynb_checkpoints
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Python application for [brief description].

      ## Setup Instructions
      ```bash
      source venv/bin/activate
      pip install -r requirements.txt
      python main.py
      ```

      ## Development Commands
      - `python main.py` - Run the application
      - `pytest tests/` - Run tests
      - `black .` - Format code
      - `flake8 .` - Lint code

  go:
    description: "Go application"
    aliases: ["golang"]
    extensions:
      - golang
    detection_patterns: ["go", "golang", "api", "service", "microservice"]
    setup_commands:
      - "go mod init {project_name}"
    dependencies:
      detect: "go.mod"
      command: "go mod download"
      requires: "go"
      description: "Go dependencies"
    files:
      "main.go": |
        package main

        import "fmt"

        func main() {
            fmt.Println("Hello from {project_name}!")
        }
      ".gitignore": |
        # Binaries
        *.exe
        *.exe~
        *.dll
        *.so
        *.dylib

        # Test binary
        *.test

        # Output
        *.out

        # Dependency directories
        vendor/

        # Go workspace
        go.work

        # Environment
        .env
        *.env

        # IDE
        .vscode/
        .idea/
        *.swp
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Go application for [brief description].

      ## Setup Instructions
      ```bash
      go mod tidy
      go run main.go
      ```

      ## Development Commands
      - `go run main.go` - Run the application
      - `go test ./...` - Run tests
      - `go build` - Build binary

  rust:
    description: "Rust application"
    aliases: ["rs"]
    extensions:
      - rust
    detection_patterns: ["rust", "rs", "cargo", "cli", "system"]
    setup_commands:
      - "cargo init --name {project_name}"
    dependencies:
      detect: "Cargo.toml"
      command: "cargo build"
      requires: "cargo"
      description: "Rust project"
      fetch_command: "cargo fetch"
    files:
      ".gitignore": |
        # Rust build
        /target/
        **/*.rs.bk
        *.pdb

        # Cargo
        Cargo.lock

        # IDE
        .vscode/
        .idea/
        *.swp

        # Environment
        .env
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Rust application for [brief description].

      ## Setup Instructions
      ```bash
      cargo build
      cargo run
      ```

      ## Development Commands
      - `cargo run` - Run the application
      - `cargo test` - Run tests
      - `cargo build --release` - Build optimized binary

  # Framework-based templates
  rails:
    description: "Ruby on Rails application"
    aliases: ["ruby", "ror"]
    extensions:
      - ruby
    detection_patterns: ["rails", "ruby", "web", "mvc"]
    setup_commands:
      - "rails new . --skip-git --force"
    dependencies:
      detect: "Gemfile"
      command: "bundle install"
      requires: "bundle"
      description: "Ruby dependencies"
    files:
      ".gitignore": |
        # Rails specific
        *.rbc
        capybara-*.html
        .rspec
        /db/*.sqlite3
        /db/*.sqlite3-journal
        /db/*.sqlite3-*
        /public/system
        /coverage/
        /spec/tmp
        *.orig
        rerun.txt
        pickle-email-*.html

        # Ignore bundler config
        /.bundle

        # Ignore all logfiles and tempfiles
        /log/*
        /tmp/*
        !/log/.keep
        !/tmp/.keep

        # Ignore uploaded files in development
        /storage/*
        !/storage/.keep

        # Ignore master key for decrypting credentials
        /config/master.key

        # Environment
        .env
        *.env

        # IDE
        .vscode/
        .idea/
        *.swp
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Ruby on Rails application for [brief description].

      ## Setup Instructions
      ```bash
      bundle install
      rails db:create db:migrate
      rails server
      ```

      ## Development Commands
      - `rails server` - Start development server
      - `rails console` - Interactive console
      - `rails test` - Run tests
      - `rails db:migrate` - Run database migrations

  django:
    description: "Django web application"
    extensions:
      - python
    detection_patterns: ["django", "web", "python"]
    setup_commands:
      - "python3 -m venv venv"
      - "source venv/bin/activate || . venv/bin/activate"
      - "pip install django"
      - "django-admin startproject {project_name} ."
    dependencies:
      detect: "requirements.txt"
      command: "pip3 install -r requirements.txt"
      requires: "pip3"
      description: "Django dependencies"
    files:
      ".gitignore": |
        # Python
        __pycache__/
        *.py[cod]
        *$py.class
        *.so

        # Virtual Environment
        venv/
        env/
        ENV/
        .venv

        # Django
        *.log
        local_settings.py
        db.sqlite3
        db.sqlite3-journal
        /media
        /static

        # Distribution / packaging
        dist/
        build/
        *.egg-info/

        # Testing
        .coverage
        .pytest_cache/
        htmlcov/

        # Environment
        .env
        *.env

        # IDE
        .vscode/
        .idea/
        *.swp
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Django web application for [brief description].

      ## Setup Instructions
      ```bash
      source venv/bin/activate
      pip install -r requirements.txt
      python manage.py migrate
      python manage.py runserver
      ```

      ## Development Commands
      - `python manage.py runserver` - Start development server
      - `python manage.py shell` - Interactive shell
      - `python manage.py test` - Run tests
      - `python manage.py migrate` - Apply migrations

  spring:
    description: "Spring Boot application"
    aliases: ["spring-boot", "spring-web", "spring-webmvc"]
    extensions:
      - jvm
    detection_patterns: ["spring", "java", "boot", "api", "microservice"]
    setup_commands:
      - "spring init --dependencies=web,data-jpa {project_name}"
    dependencies:
      detect: "pom.xml"
      command: "./mvnw dependency:resolve"
      requires: "java"
      description: "Maven dependencies"
    files:
      ".gitignore": |
        # Compiled class files
        *.class

        # Log files
        *.log

        # Package files
        *.jar
        *.war
        *.nar
        *.ear
        *.zip
        *.tar.gz
        *.rar

        # Maven
        target/
        pom.xml.tag
        pom.xml.releaseBackup
        pom.xml.versionsBackup
        pom.xml.next
        release.properties
        dependency-reduced-pom.xml
        buildNumber.properties
        .mvn/timing.properties
        .mvn/wrapper/maven-wrapper.jar

        # Gradle
        .gradle/
        build/
        !gradle/wrapper/gradle-wrapper.jar

        # Environment
        .env
        *.env

        # IDE
        .vscode/
        .idea/
        *.iml
        *.swp
        .project
        .classpath
        .settings/
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Spring Boot application for [brief description].

      ## Setup Instructions
      ```bash
      ./mvnw spring-boot:run
      ```

      ## Development Commands
      - `./mvnw spring-boot:run` - Start application
      - `./mvnw test` - Run tests
      - `./mvnw clean package` - Build JAR

  dotnet:
    description: ".NET application"
    aliases: ["csharp", "c#", ".net"]
    extensions:
      - dotnet
    detection_patterns: ["dotnet", "csharp", "c#", "api", "web", "blazor"]
    setup_commands:
      - "dotnet new web"
    dependencies:
      detect: ["*.csproj", "*.sln"]
      command: "dotnet restore"
      requires: "dotnet"
      description: ".NET dependencies"
    files:
      ".gitignore": |
        # Build results
        [Dd]ebug/
        [Dd]ebugPublic/
        [Rr]elease/
        [Rr]eleases/
        x64/
        x86/
        [Ww][Ii][Nn]32/
        [Aa][Rr][Mm]/
        [Aa][Rr][Mm]64/
        bld/
        [Bb]in/
        [Oo]bj/
        [Ll]og/
        [Ll]ogs/

        # NuGet packages
        *.nupkg
        *.snupkg
        **/[Pp]ackages/*
        !**/[Pp]ackages/build/

        # .NET Core
        project.lock.json
        project.fragment.lock.json
        artifacts/

        # User-specific files
        *.rsuser
        *.suo
        *.user
        *.userosscache
        *.sln.docstates

        # Environment
        .env
        *.env
        appsettings.*.json
        !appsettings.Development.json

        # IDE
        .vscode/
        .idea/
        *.swp
        .vs/
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a .NET application for [brief description].

      ## Setup Instructions
      ```bash
      dotnet restore
      dotnet run
      ```

      ## Development Commands
      - `dotnet run` - Start application
      - `dotnet test` - Run tests
      - `dotnet build` - Build application

  # Infrastructure templates
  terraform:
    description: "Terraform infrastructure project"
    aliases: ["tf", "infra", "infrastructure"]
    extensions:
      - infra-tools
    detection_patterns: ["terraform", "tf", "infrastructure", "infra", "iac"]
    setup_commands: []
    files:
      "main.tf": |
        # {project_name} Infrastructure

        terraform {
          required_version = ">= 1.0"
          required_providers {
            aws = {
              source  = "hashicorp/aws"
              version = "~> 5.0"
            }
          }
        }

        provider "aws" {
          region = var.aws_region
        }
      "variables.tf": |
        variable "aws_region" {
          description = "AWS region"
          type        = string
          default     = "us-west-2"
        }

        variable "environment" {
          description = "Environment name"
          type        = string
          default     = "dev"
        }
      "outputs.tf": |
        # Add outputs here
      ".gitignore": |
        # Terraform
        .terraform/
        .terraform.lock.hcl
        *.tfstate
        *.tfstate.*
        crash.log
        crash.*.log
        *.tfvars
        *.tfvars.json
        override.tf
        override.tf.json
        *_override.tf
        *_override.tf.json
        .terraformrc
        terraform.rc

        # Environment
        .env
        *.env

        # IDE
        .vscode/
        .idea/
        *.swp
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Terraform infrastructure project for [brief description].

      ## Setup Instructions
      ```bash
      terraform init
      terraform plan
      terraform apply
      ```

      ## Development Commands
      - `terraform plan` - Show execution plan
      - `terraform apply` - Apply changes
      - `terraform destroy` - Destroy infrastructure
      - `terraform fmt` - Format files

  docker:
    description: "Dockerized application"
    aliases: ["container", "containerized"]
    extensions:
      - docker
    detection_patterns: ["docker", "container", "microservice"]
    setup_commands: []
    files:
      "Dockerfile": |
        FROM node:18-alpine

        WORKDIR /app

        COPY package*.json ./
        RUN npm ci --only=production

        COPY . .

        EXPOSE 3000

        CMD ["npm", "start"]
      "docker-compose.yml": |
        version: '3.8'
        services:
          app:
            build: .
            ports:
              - "3000:3000"
            environment:
              - NODE_ENV=development
      ".gitignore": |
        # Docker
        .docker/

        # Environment
        .env
        .env.*
        *.env

        # Build outputs
        build/
        dist/

        # Dependencies
        node_modules/

        # IDE
        .vscode/
        .idea/
        *.swp

        # OS
        .DS_Store
        Thumbs.db

        # Logs
        *.log
        logs/
    claude_md_template: |
      # {project_name}

      ## Project Overview
      This is a Dockerized application for [brief description].

      ## Setup Instructions
      ```bash
      docker compose up --build
      ```

      ## Development Commands
      - `docker compose up` - Start containers
      - `docker compose down` - Stop containers
      - `docker compose logs` - View logs
      - `docker build -t {project_name} .` - Build image

  # Default/general template for unknown project types
  general:
    description: "General purpose project"
    extensions: []
    detection_patterns: []
    setup_commands: []
    files:
      ".gitignore": |
        # Build outputs
        build/
        dist/
        out/
        target/

        # Dependencies
        node_modules/
        vendor/

        # Environment
        .env
        .env.*
        *.env

        # IDE
        .vscode/
        .idea/
        *.swp
        *.swo
        *~

        # OS
        .DS_Store
        Thumbs.db

        # Logs
        *.log
        logs/

        # Temporary
        tmp/
        temp/
        .cache/
    claude_md_template: |
      # {project_name}

      ## Project Overview
      [Add project description]

      ## Setup Instructions
      [Add setup instructions]

      ## Development Commands
      [Add development commands]

# Detection rules for auto-type selection
detection_rules:
  # Name pattern matching (case-insensitive)
  name_patterns:
    - pattern: ".*-?rails?-?.*"
      type: "rails"
    - pattern: ".*-?django-?.*"
      type: "django"
    - pattern: ".*-?spring-?.*"
      type: "spring"
    - pattern: ".*-?api.*"
      types: ["node", "go", "python", "dotnet", "spring"]
    - pattern: ".*-?web.*"
      types: ["node", "rails", "django", "dotnet"]
    - pattern: ".*-?infra.*|.*-?infrastructure.*"
      type: "terraform"
    - pattern: ".*-?tf.*|.*-?terraform.*"
      type: "terraform"
    - pattern: ".*-?docker.*"
      type: "docker"
    - pattern: ".*-?service.*|.*-?microservice.*"
      types: ["go", "node", "spring", "dotnet"]

  # Common framework keywords
  framework_keywords:
    rails: ["rails", "ruby"]
    django: ["django", "python"]
    spring: ["spring", "java", "kotlin"]
    dotnet: ["dotnet", "csharp", "blazor", "aspnet"]
    terraform: ["terraform", "infra", "infrastructure", "iac"]
    docker: ["docker", "container"]
