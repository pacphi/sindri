---
metadata:
  name: xfce-ubuntu
  version: 2.0.0
  description: XFCE desktop with xRDP remote access for GUI development
  category: desktop
  author: Sindri Team
  homepage: https://www.xfce.org
  dependencies: []

requirements:
  domains:
    - archive.ubuntu.com
    - security.ubuntu.com
  diskSpace: 2500
  memory: 1024
  installTime: 300

install:
  method: hybrid
  apt:
    updateFirst: true
    packages:
      - xfce4
      - xfce4-goodies
      - xrdp
      - dbus-x11
      - xfonts-base
      - xauth
      - x11-xserver-utils
      - firefox
      - mousepad
      - thunar
  script:
    path: post-install.sh
    timeout: 300

configure:
  templates:
    - source: xsession.template
      destination: ~/.xsession
      mode: overwrite
    - source: xfwm4.xml.template
      destination: ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfwm4.xml
      mode: overwrite
  environment:
    - key: DISPLAY
      value: ":0"
      scope: bashrc
    - key: XDG_SESSION_TYPE
      value: "x11"
      scope: bashrc

validate:
  commands:
    - name: startxfce4
    - name: xrdp
      versionFlag: "-v"
      expectedPattern: "xrdp\\s+\\d+\\.\\d+\\.\\d+"
    - name: firefox
      versionFlag: "--version"
      expectedPattern: "Firefox\\s+\\d+"
    - name: mousepad
      versionFlag: "--version"
    - name: thunar
      versionFlag: "--version"

remove:
  confirmation: true
  apt:
    packages:
      - xfce4
      - xfce4-goodies
      - xrdp
      - dbus-x11
      - xfonts-base
      - xauth
      - x11-xserver-utils
      - firefox
      - mousepad
      - thunar
  paths:
    - ~/.xsession
    - ~/.config/xfce4

upgrade:
  strategy: automatic
  apt:
    packages:
      - xfce4
      - xfce4-goodies
      - xrdp
      - firefox
      - mousepad
    updateFirst: true

bom:
  # EXCEPTIONAL CASE: Desktop environment via apt (cannot pin reliably)
  # Versions depend on Ubuntu release
  tools:
    - name: xfce4
      version: dynamic  # apt-managed
      source: apt
      type: framework
      license: GPL-2.0
      homepage: https://www.xfce.org
      purl: pkg:deb/ubuntu/xfce4
    - name: xrdp
      version: dynamic
      source: apt
      type: server
      license: Apache-2.0
      homepage: http://www.xrdp.org
      purl: pkg:deb/ubuntu/xrdp
    - name: firefox
      version: dynamic
      source: apt
      type: utility
      license: MPL-2.0
      homepage: https://www.mozilla.org/firefox
      purl: pkg:deb/ubuntu/firefox
    - name: mousepad
      version: dynamic
      source: apt
      type: utility
      license: GPL-2.0
      homepage: https://docs.xfce.org/apps/mousepad
      purl: pkg:deb/ubuntu/mousepad
    - name: thunar
      version: dynamic
      source: apt
      type: utility
      license: GPL-2.0
      homepage: https://docs.xfce.org/xfce/thunar/
      purl: pkg:deb/ubuntu/thunar
  files:
    - path: ~/.xsession
      type: config
    - path: ~/.config/xfce4
      type: config
docs:
  title: "XFCE Ubuntu"
  overview: |
    XFCE desktop with xRDP remote access for GUI development. Provides a lightweight desktop environment accessible via RDP.
  last-updated: "2026-01-26"
  features:
    - "Lightweight - Low resource usage"
    - "RDP Access - Connect from Windows/Mac/Linux"
    - "Full Desktop - Complete GUI environment"
    - "Development Ready - GUI development and testing"
  usage:
    - section: "Connecting via RDP"
      examples:
        - code: |
            # Default RDP port: 3389
            # From Windows: mstsc.exe
            # From Mac: Microsoft Remote Desktop
            # From Linux: rdesktop, freerdp, or Remmina

            # Connect to:
            # hostname:3389
    - section: "Starting XFCE"
      examples:
        - code: |
            # Start manually
            startxfce4

            # Via xRDP (automatic on RDP connection)
            # Configure in ~/.xsession
    - section: "Service Management"
      examples:
        - code: |
            # Start xRDP
            sudo systemctl start xrdp

            # Check status
            sudo systemctl status xrdp

            # Enable on boot
            sudo systemctl enable xrdp
    - section: "Desktop Applications"
      examples:
        - code: |
            # File manager
            thunar

            # Text editor
            mousepad file.txt

            # Web browser
            firefox

            # Terminal
            xfce4-terminal
    - section: "Customization"
      examples:
        - code: |
            # XFCE settings
            xfce4-settings-manager

            # Display settings
            xfce4-display-settings

            # Panel preferences
            xfce4-panel --preferences
  related:
    - name: guacamole
      description: "Web-based remote access"
